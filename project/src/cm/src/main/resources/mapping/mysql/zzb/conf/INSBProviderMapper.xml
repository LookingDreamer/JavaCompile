<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.zzb.conf.entity">
	<!-- INSBProvider  -->
	<select id="INSBProvider_insert" parameterType="com.zzb.conf.entity.INSBProvider" resultType="int">
		insert into INSBProvider
		(id,operator,createtime,modifytime,noti,prvcode,prvname,prvshotname,prvgrade,prvtype,prvurl,linkname,linktel,address,province,city,county,fax,email,servictel,parentcode,permissionorg,affiliationorg,businesstype,channeltype,logo,companyintroduce,quotationtime,quotationinterval,insuretime,quotationvalidity,payvalidity,quickinsureflag,childflag,eidid,interfacetype,trialflag,priceflag,underwritingflag,pluginflag,orderflag,advancequote) 
		values
		(#{id},#{operator},#{createtime},#{modifytime},#{noti},#{prvcode},#{prvname},#{prvshotname},#{prvgrade},#{prvtype},#{prvurl},#{linkname},#{linktel},#{address},#{province},#{city},#{county},#{fax},#{email},#{servictel},#{parentcode},#{permissionorg},#{affiliationorg},#{businesstype},#{channeltype},#{logo},#{companyintroduce},#{quotationtime},#{quotationinterval},#{insuretime},#{quotationvalidity},#{payvalidity},#{quickinsureflag},#{childflag},#{eidid},#{interfacetype},#{trialflag},#{priceflag},#{underwritingflag},#{pluginflag},#{orderflag},#{advancequote}) 
	</select>
	
	<select id="INSBProvider_selectByParentProTreeCode" parameterType="String" resultType="com.zzb.conf.entity.INSBProvider">
		select pro.* from INSBProvider pro where parentcode = #{value} 
	</select>
	<select id="INSBProvider_selectByParentProTreeCodeStair" parameterType="String" resultType="com.zzb.conf.entity.INSBProvider">
		select pro.* from INSBProvider pro where parentcode = '' 
	</select>
	
	<select id="INSBProvider_selectByModifytime" parameterType="String" resultType="com.zzb.conf.entity.INSBProvider">
		select * from INSBProvider 
		<where>
				 DATE_FORMAT(modifytime, '%Y-%c-%d') = #{modifytime}
		</where>
	</select>
	
	<select id="INSBProvider_queryListPro" parameterType="String" resultType="com.zzb.conf.entity.INSBProvider">
		select pro.* FROM insbprovider pro  LEFT JOIN insbproviderandedi proedi ON  pro.id = proedi.providerid WHERE proedi.ediid = #{ediid}
	</select>
	
	
	<select id="INSBProvider_selectProviderdata" parameterType="String" resultType="com.zzb.conf.entity.INSBProvider">
		select * FROM insbprovider WHERE parentcode IS NULL OR parentcode=''
	</select>
	
	
	<select id="INSBProvider_selectByParentProTreeCode2" parameterType="com.zzb.model.ProOrParModel" resultType="com.zzb.conf.entity.INSBProvider">
		SELECT	pro.* FROM	INSBProvider pro
		LEFT JOIN inscdept dept ON dept.id = pro.affiliationorg
		<where>
		<if test="prvname!=null">
			pro.prvname LIKE CONCAT(#{prvname},'%')
		</if>
		<if test="prvgrade!=null">
			pro.prvgrade LIKE CONCAT('%',#{prvgrade},'%')
		</if>
		<if test="businesstype!=null">
  			pro.businesstype = #{businesstype}
		</if>
		<if test="affiliationorg!=null">
			pro.affiliationorg = #{affiliationorg}
		</if>
		<if test="parentcode!=null">
			pro.parentcode =  #{parentcode}
		</if>
		<if test="orderflag!=null">
			pro.orderflag =  #{orderflag}
		</if>
		</where>
	</select>
	
	<select id="INSBProvider_selectListIn" parameterType="Map" resultType="com.zzb.conf.entity.INSBProvider">  
	    select * from INSBProvider 
			where id IN
			<foreach item="itemProvideId" index="index" collection="provideIdList" open="(" separator="," close=")">  
			     #{itemProvideId}
			</foreach>
	</select>  
	
	<select id="INSBProvider_selectByInsureAreaCode" parameterType="String" resultType="com.zzb.conf.entity.INSBProvider">
		SELECT	* FROM	INSBProvider where city =  #{city}
	</select>
	
	<select id="INSBProvider_selectByDeptId" parameterType="String"
		resultType="com.zzb.conf.entity.INSBProvider">
		select * from INSBProvider where affiliationorg = #{deptId}
	</select>
	
	<select id="INSBProvider_prvcode" parameterType="String"
		resultType="com.zzb.conf.entity.INSBProvider">
		select * from INSBProvider where prvcode = #{prvcode}
	</select>
	<select id="INSBProvider_seelctListMapByPCode" parameterType="String"
		resultType="Map">
		select prvcode id,parentcode pId,prvname name from INSBProvider where parentcode = #{parentcode}
	</select>
	
	<select id="INSBProvider_select" parameterType="Map" resultType="com.zzb.conf.entity.INSBProvider">
		select * from INSBProvider
		<where>
			<if test="prvcode != null">
				and prvcode = #{prvcode}
			</if>
			<if test="prvname != null">
				and prvname = #{prvname}
			</if>
			<if test="prvshotname != null">
				and prvshotname = #{prvshotname}
			</if>
			<if test="prvgrade != null">
				and prvgrade = #{prvgrade}
			</if>
			<if test="prvtype != null">
				and prvtype = #{prvtype}
			</if>
			<if test="prvurl != null">
				and prvurl = #{prvurl}
			</if>
			<if test="linkname != null">
				and linkname = #{linkname}
			</if>
			<if test="linktel != null">
				and linktel = #{linktel}
			</if>
			<if test="address != null">
				and address = #{address}
			</if>
			<if test="province != null">
				and province = #{province}
			</if>
			<if test="city != null">
				and city = #{city}
			</if>
			<if test="county != null">
				and county = #{county}
			</if>
			<if test="fax != null">
				and fax = #{fax}
			</if>
			<if test="email != null">
				and email = #{email}
			</if>
			<if test="servictel != null">
				and servictel = #{servictel}
			</if>
			<if test="parentcode != null">
				and parentcode = #{parentcode}
			</if>
			<if test="permissionorg != null">
				and permissionorg = #{permissionorg}
			</if>
			<if test="affiliationorg != null">
				and affiliationorg = #{affiliationorg}
			</if>
			<if test="businesstype != null">
				and businesstype = #{businesstype}
			</if>
			<if test="channeltype != null">
				and channeltype = #{channeltype}
			</if>
			<if test="logo != null">
				and logo = #{logo}
			</if>
			<if test="companyintroduce != null">
				and companyintroduce = #{companyintroduce}
			</if>
			<if test="quotationtime != null">
				and quotationtime = #{quotationtime}
			</if>
			<if test="quotationinterval != null">
				and quotationinterval = #{quotationinterval}
			</if>
			<if test="insuretime != null">
				and insuretime = #{insuretime}
			</if>
			<if test="quotationvalidity != null">
				and quotationvalidity = #{quotationvalidity}
			</if>
			<if test="payvalidity != null">
				and payvalidity = #{payvalidity}
			</if>
			<if test="quickinsureflag != null">
				and quickinsureflag = #{quickinsureflag}
			</if>
			<if test="childflag != null">
				and childflag = #{childflag}
			</if>
			<if test="eidid != null">
				and eidid = #{eidid}
			</if>
			<if test="interfacetype != null">
				and interfacetype = #{interfacetype}
			</if>
			<if test="trialflag != null">
				and trialflag = #{trialflag}
			</if>
			<if test="priceflag != null">
				and priceflag = #{priceflag}
			</if>
			<if test="underwritingflag != null">
				and underwritingflag = #{underwritingflag}
			</if>
			<if test="pluginflag != null">
				and pluginflag = #{pluginflag}
			</if>
			<if test="operator != null">
				and operator = #{operator}
			</if>
			<if test="orderflag != null">
				and orderflag = #{orderflag}
			</if>
			<if test="advancequote != null">
				and advancequote = #{advancequote}
			</if>
		</where>
	</select>
	<select id="INSBProvider_selectOne" parameterType="Map" resultType="com.zzb.conf.entity.INSBProvider">
		select * from INSBProvider
		<where>
			<if test="prvcode != null">
				and prvcode = #{prvcode}
			</if>
			<if test="prvname != null">
				and prvname = #{prvname}
			</if>
			<if test="prvshotname != null">
				and prvshotname = #{prvshotname}
			</if>
			<if test="prvgrade != null">
				and prvgrade = #{prvgrade}
			</if>
			<if test="prvtype != null">
				and prvtype = #{prvtype}
			</if>
			<if test="prvurl != null">
				and prvurl = #{prvurl}
			</if>
			<if test="linkname != null">
				and linkname = #{linkname}
			</if>
			<if test="linktel != null">
				and linktel = #{linktel}
			</if>
			<if test="address != null">
				and address = #{address}
			</if>
			<if test="province != null">
				and province = #{province}
			</if>
			<if test="city != null">
				and city = #{city}
			</if>
			<if test="county != null">
				and county = #{county}
			</if>
			<if test="fax != null">
				and fax = #{fax}
			</if>
			<if test="email != null">
				and email = #{email}
			</if>
			<if test="servictel != null">
				and servictel = #{servictel}
			</if>
			<if test="parentcode != null">
				and parentcode = #{parentcode}
			</if>
			<if test="permissionorg != null">
				and permissionorg = #{permissionorg}
			</if>
			<if test="affiliationorg != null">
				and affiliationorg = #{affiliationorg}
			</if>
			<if test="businesstype != null">
				and businesstype = #{businesstype}
			</if>
			<if test="channeltype != null">
				and channeltype = #{channeltype}
			</if>
			<if test="logo != null">
				and logo = #{logo}
			</if>
			<if test="companyintroduce != null">
				and companyintroduce = #{companyintroduce}
			</if>
			<if test="quotationtime != null">
				and quotationtime = #{quotationtime}
			</if>
			<if test="quotationinterval != null">
				and quotationinterval = #{quotationinterval}
			</if>
			<if test="insuretime != null">
				and insuretime = #{insuretime}
			</if>
			<if test="quotationvalidity != null">
				and quotationvalidity = #{quotationvalidity}
			</if>
			<if test="payvalidity != null">
				and payvalidity = #{payvalidity}
			</if>
			<if test="quickinsureflag != null">
				and quickinsureflag = #{quickinsureflag}
			</if>
			<if test="childflag != null">
				and childflag = #{childflag}
			</if>
			<if test="eidid != null">
				and eidid = #{eidid}
			</if>
			<if test="interfacetype != null">
				and interfacetype = #{interfacetype}
			</if>
			<if test="trialflag != null">
				and trialflag = #{trialflag}
			</if>
			<if test="priceflag != null">
				and priceflag = #{priceflag}
			</if>
			<if test="underwritingflag != null">
				and underwritingflag = #{underwritingflag}
			</if>
			<if test="pluginflag != null">
				and pluginflag = #{pluginflag}
			</if>
			<if test="operator != null">
				and operator = #{operator}
			</if>
			<if test="orderflag != null">
				and orderflag = #{orderflag}
			</if>
			<if test="advancequote != null">
				and advancequote = #{advancequote}
			</if>
		</where>
		limit 2
	</select>
	<select id="INSBProvider_selectById" parameterType="String" resultType="com.zzb.conf.entity.INSBProvider">
		select * from INSBProvider where id = #{id}
	</select>
	<select id="INSBProvider_deleteById" parameterType="String">
		delete from INSBProvider where id = #{id}
	</select>
	<select id="INSBProvider_updateById" parameterType="com.zzb.conf.entity.INSBProvider">
		update INSBProvider  set 
		<if test="operator != null">operator = #{operator},</if>
		<if test="province != null">province = #{province},</if>
		<if test="city != null">city = #{city}, </if>
		<if test="fax != null">fax = #{fax},</if>
		<if test="email != null">email=#{email} ,</if>
		<if test="modifytime != null">modifytime = #{modifytime},</if>
		<if test="prvcode != null">prvcode = #{prvcode},</if>
		<if test="prvname != null">prvname = #{prvname},</if>
		<if test="prvshotname != null">prvshotname = #{prvshotname},</if>
		<if test="prvgrade != null">prvgrade = #{prvgrade},</if>
		<if test="prvtype != null">prvtype = #{prvtype},</if>
		<if test="prvurl != null">prvurl = #{prvurl},</if>
		<if test="linkname != null">linkname = #{linkname},</if>
		<if test="linktel != null">linktel = #{linktel},</if>
		<if test="address != null">address = #{address},</if>
		<if test="servictel != null">servictel = #{servictel},</if>
		<if test="parentcode != null">parentcode = #{parentcode},</if>
		<if test="permissionorg != null">permissionorg = #{permissionorg},</if>
		<if test="affiliationorg != null">affiliationorg = #{affiliationorg},</if>
		<if test="businesstype != null">businesstype = #{businesstype},</if>
		<if test="channeltype != null">channeltype = #{channeltype},</if>
		<if test="logo != null">logo = #{logo},</if>
		<if test="companyintroduce != null">companyintroduce = #{companyintroduce},</if>
		<if test="quotationtime != null">quotationtime = #{quotationtime},</if>
		<if test="quotationinterval != null">quotationinterval = #{quotationinterval},</if>
		<if test="insuretime != null">insuretime = #{insuretime},</if>
		<if test="quotationvalidity != null">quotationvalidity = #{quotationvalidity},</if>
		<if test="payvalidity != null">payvalidity = #{payvalidity},</if>
		<if test="quickinsureflag != null">quickinsureflag = #{quickinsureflag},</if>
		<if test="orderflag != null">orderflag = #{orderflag},</if>
		<if test="advancequote != null">advancequote = #{advancequote},</if>
		id = #{id}
		where id = #{id}
	</select>
	
	<update id="INSBProvider_updateProById" parameterType="com.zzb.conf.entity.INSBProvider">
		update INSBProvider  set childflag = '1' where id = #{id}
	</update>
	
	<update id="INSBProvider_updateProByIddel" parameterType="com.zzb.conf.entity.INSBProvider">
		update INSBProvider  set childflag = '0' where id = #{id}
	</update>
	
	<select id="INSBProvider_selectCount" parameterType="Map" resultType="Long">
		select count(1) from INSBProvider
		<where>
			<if test="prvcode != null">
				and prvcode = #{prvcode}
			</if>
			<if test="prvname != null">
				and prvname = #{prvname}
			</if>
			<if test="prvshotname != null">
				and prvshotname = #{prvshotname}
			</if>
			<if test="prvgrade != null">
				and prvgrade = #{prvgrade}
			</if>
			<if test="prvtype != null">
				and prvtype = #{prvtype}
			</if>
			<if test="prvurl != null">
				and prvurl = #{prvurl}
			</if>
			<if test="linkname != null">
				and linkname = #{linkname}
			</if>
			<if test="linktel != null">
				and linktel = #{linktel}
			</if>
			<if test="address != null">
				and address = #{address}
			</if>
			<if test="province != null">
				and province = #{province}
			</if>
			<if test="city != null">
				and city = #{city}
			</if>
			<if test="county != null">
				and county = #{county}
			</if>
			<if test="fax != null">
				and fax = #{fax}
			</if>
			<if test="email != null">
				and email = #{email}
			</if>
			<if test="servictel != null">
				and servictel = #{servictel}
			</if>
			<if test="parentcode != null">
				and parentcode = #{parentcode}
			</if>
			<if test="permissionorg != null">
				and permissionorg = #{permissionorg}
			</if>
			<if test="affiliationorg != null">
				and affiliationorg = #{affiliationorg}
			</if>
			<if test="businesstype != null">
				and businesstype = #{businesstype}
			</if>
			<if test="channeltype != null">
				and channeltype = #{channeltype}
			</if>
			<if test="logo != null">
				and logo = #{logo}
			</if>
			<if test="companyintroduce != null">
				and companyintroduce = #{companyintroduce}
			</if>
			<if test="quotationtime != null">
				and quotationtime = #{quotationtime}
			</if>
			<if test="quotationinterval != null">
				and quotationinterval = #{quotationinterval}
			</if>
			<if test="insuretime != null">
				and insuretime = #{insuretime}
			</if>
			<if test="quotationvalidity != null">
				and quotationvalidity = #{quotationvalidity}
			</if>
			<if test="payvalidity != null">
				and payvalidity = #{payvalidity}
			</if>
			<if test="quickinsureflag != null">
				and quickinsureflag = #{quickinsureflag}
			</if>
			<if test="childflag != null">
				and childflag = #{childflag}
			</if>
			<if test="eidid != null">
				and eidid = #{eidid}
			</if>
			<if test="interfacetype != null">
				and interfacetype = #{interfacetype}
			</if>
			<if test="trialflag != null">
				and trialflag = #{trialflag}
			</if>
			<if test="priceflag != null">
				and priceflag = #{priceflag}
			</if>
			<if test="underwritingflag != null">
				and underwritingflag = #{underwritingflag}
			</if>
			<if test="pluginflag != null">
				and pluginflag = #{pluginflag}
			</if>
			<if test="operator != null">
				and operator = #{operator}
			</if>
			<if test="orderflag != null">
				and orderflag = #{orderflag}
			</if>
			<if test="advancequote != null">
				and advancequote = #{advancequote}
			</if>
		</where>
	</select>
	<select id="INSBProvider_getQuotationValidityById"  parameterType="String" resultType="int">
		select quotationvalidity FROM insbprovider WHERE id = #{id}
	</select>
	<select id="INSBProvider_selectFatherProvider" parameterType="String" resultType="com.zzb.conf.entity.INSBProvider">
		select * FROM INSBProvider a WHERE id =SUBSTR(#{id},1,4)
	</select>
	
	<select id="INSBProvider_selectEdiProvider" parameterType="String" resultType="Map">
		select DISTINCT
		    a.id as id,a.prvcode as prvcode,a.parentcode as pId,a.prvname as name,a.childflag as isParent
		FROM insbprovider a 
		LEFT JOIN insbagreement b ON a.id = b.providerid
		WHERE b.deptid = #{userdept}
	</select>
	
	<select id="INSBProvider_selectEdiAllProvider" parameterType="String" resultType="Map">
		select DISTINCT
		    a.id as id,a.prvcode as prvcode,a.parentcode as pId,a.prvname as name,a.childflag as isParent
		FROM insbprovider a 
		RIGHT JOIN insbagreement b ON a.id = b.providerid
	</select>
	<select id="INSBProvider_selectByInsureAreaCode2" parameterType="Map" resultType="com.zzb.conf.entity.INSBProvider">
		SELECT insb2.prvcode,insb.prvshotname,insb2.businesstype from insbprovider insb,(SELECT DISTINCT p.prvcode,p.businesstype
		FROM insbprovider p,insbchannelagreement ca,insbagreementprovider ap,insbchannel c,insbagreementarea
		aa,insbchannel c1,insbagreement agr,insbagreementdept agdept   
		<where>
			and c.id = ca.channelid
			AND c.deptid = ca.deptid
			AND ap.agreementid = ca.id
			AND p.id = ap.providerid
			and aa.agreementid=ca.id
			and c1.channelcode = c.upchannelcode
			and ap.providerid = agr.providerid AND ap.agreeid = agr.id
			and agdept.agreementid = ca.id and agdept.providerid = ap.providerid
			and ca.agreementstatus='1'
			and c1.childflag='1'
			AND (c.deleteflag != 0 OR c.deleteflag is null)
			and agr.agreementstatus = '1'
			<if test="channelinnercode != null">
				and c1.channelinnercode = #{channelinnercode}
			</if>
			<if test="city != null">
				and aa.city = #{city} 
			</if>
		</where>)insb2 where insb.prvcode=SUBSTR(insb2.prvcode,1,4)
	</select>
	
</mapper>