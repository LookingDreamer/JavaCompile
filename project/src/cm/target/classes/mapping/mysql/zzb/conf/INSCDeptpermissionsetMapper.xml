<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.zzb.conf.entity">
	<!-- INSCDeptpermissionset -->
	<select id="INSCDeptpermissionset_insert" parameterType="com.zzb.conf.entity.INSCDeptpermissionset" resultType="int">
		insert into INSCDeptpermissionset
		(id,operator,createtime,modifytime,noti,comcode,trysetid,formalsetid,channelsetid) 
		values 
		(#{id},#{operator},#{createtime},#{modifytime},#{noti},#{comcode},#{trysetid},#{formalsetid},#{channelsetid}) 
	</select>
	<select id="INSCDeptpermissionset_select" parameterType="Map" resultType="com.zzb.conf.entity.INSCDeptpermissionset">
		select * from INSCDeptpermissionset
		<where>
			<if test="comcode != null">
				and comcode = #{comcode}
			</if>
			<if test="trysetid != null">
				and trysetid = #{trysetid}
			</if>
			<if test="formalsetid != null">
				and formalsetid = #{formalsetid}
			</if>
			<if test="channelsetid != null">
				and channelsetid = #{channelsetid}
			</if>
		</where>
	</select>
	<select id="INSCDeptpermissionset_selectById" parameterType="String" resultType="com.zzb.conf.entity.INSCDeptpermissionset">
		select * from INSCDeptpermissionset where id = #{id}
	</select>
	<select id="INSCDeptpermissionset_deleteById" parameterType="String">
		delete from INSCDeptpermissionset where id = #{id}
	</select>
	<select id="INSCDeptpermissionset_updateById" parameterType="com.zzb.conf.entity.INSCDeptpermissionset">
		update INSCDeptpermissionset  set operator = #{operator},modifytime = #{modifytime},noti = #{noti},comcode = #{comcode},trysetid = #{trysetid},formalsetid = #{formalsetid},channelsetid = #{channelsetid} where id = #{id}
	</select>
	<select id="INSCDeptpermissionset_updateBycomcode" parameterType="com.zzb.conf.entity.INSCDeptpermissionset">
		update INSCDeptpermissionset  set operator = #{operator},modifytime = #{modifytime},noti = #{noti},trysetid = #{trysetid},formalsetid = #{formalsetid},channelsetid = #{channelsetid} where comcode = #{comcode}
	</select>
	<select id="INSCDeptpermissionset_selectCount" parameterType="Map" resultType="Long">
		select count(1) from INSCDeptpermissionset
		<where>
			<if test="comcode != null">
				and comcode = #{comcode}
			</if>
			<if test="trysetid != null">
				and trysetid = #{trysetid}
			</if>
			<if test="formalsetid != null">
				and formalsetid = #{formalsetid}
			</if>
			<if test="channelsetid != null">
				and channelsetid = #{channelsetid}
			</if>
		</where>
	</select>
	<select id="INSCDeptpermissionset_queryByComcode" parameterType="String" resultType="Map">
		select a.*,
		b.setcode AS tryset,
		c.setcode AS formalset,
		d.setcode AS channelset
		from INSCDeptpermissionset a
		LEFT JOIN insbpermissionset b ON b.id=a.trysetid
		LEFT JOIN insbpermissionset c ON c.id=a.formalsetid
		LEFT JOIN insbpermissionset d ON d.id=a.channelsetid		
		where comcode = #{comcode}
	</select>
	<select id="INSCDeptpermissionset_selectDeptByDeptid" parameterType="Map" resultType="com.zzb.conf.entity.INSCDeptpermissionset">
		select * FROM inscdeptpermissionset s where 1 = 1
		AND EXISTS(
		select 1 FROM (
		select T2.comcode
		FROM (
		SELECT
		@r AS _id,
		(select @r := upcomcode FROM inscdept WHERE comcode = _id) AS parent_id,
		@l := @l + 1 AS lvl
		FROM
		(select @r := #{deptid}, @l := '') vars,
		inscdept h
		WHERE @r &lt;&gt; '') T1
		JOIN inscdept T2
		ON T1._id = T2.comcode
		) parents WHERE parents.comcode = s.comcode
		)
		ORDER BY s.comcode DESC,createtime DESC
	</select>
	<select id="INSCDeptpermissionset_selectDeptByComcode" parameterType="String" resultType="com.zzb.conf.entity.INSCDeptpermissionset">
		select * from INSCDeptpermissionset where comcode = #{comcode}
	</select>
</mapper>