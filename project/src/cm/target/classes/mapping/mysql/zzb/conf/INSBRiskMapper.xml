<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.zzb.conf.entity">
	<!-- INSBRisk -->
	<select id="INSBRisk_insert" parameterType="com.zzb.conf.entity.INSBRisk"
		resultType="int">
		insert into INSBRisk
		(id,operator,createtime,modifytime,noti,riskcode,riskname,riskshortname,risktype,provideid,status,renewaltype)
		values
		(#{id},#{operator},#{createtime},#{modifytime},#{noti},#{riskcode},#{riskname},#{riskshortname},#{risktype},#{provideid},#{status},#{renewaltype})
	</select>
	<select id="INSBRisk_select" parameterType="Map" resultType="com.zzb.conf.entity.INSBRisk">
		select * from INSBRisk
		<where>
			<if test="riskcode != null">
				and riskcode = #{riskcode}
			</if>
			<if test="riskname != null">
				and riskname = #{riskname}
			</if>
			<if test="riskshortname != null">
				and riskshortname = #{riskshortname}
			</if>
		<!-- 	<if test="risktype != null">
				and risktype = #{risktype}
			</if> -->
			<if test="provideid != null">
				and provideid = #{provideid}
			</if>
			<if test="status != null">
				and status = #{status}
			</if>
			<if test="renewaltype != null">
				and renewaltype = #{renewaltype}
			</if>
		</where>
	</select>
	<select id="INSBRisk_selectOne" parameterType="Map" resultType="com.zzb.conf.entity.INSBRisk">
		select * from INSBRisk
		<where>
			<if test="riskcode != null">
				and riskcode = #{riskcode}
			</if>
			<if test="riskname != null">
				and riskname = #{riskname}
			</if>
			<if test="riskshortname != null">
				and riskshortname = #{riskshortname}
			</if>
			<if test="risktype != null">
				and risktype = #{risktype}
			</if>
			<if test="provideid != null">
				and provideid = #{provideid}
			</if>
			<if test="status != null">
				and status = #{status}
			</if>
			<if test="renewaltype != null">
				and renewaltype = #{renewaltype}
			</if>
		</where>
		limit 2
	</select>
	<select id="INSBRisk_selectById" parameterType="String"
		resultType="com.zzb.conf.entity.INSBRisk">
		select * from INSBRisk where id = #{id}
	</select>
	<select id="INSBRisk_deleteById" parameterType="String">
		delete from
		INSBRisk where id = #{id}
	</select>
	<select id="INSBRisk_updateById" parameterType="com.zzb.conf.entity.INSBRisk">
		update INSBRisk
		set operator = #{operator},modifytime = #{modifytime},noti =
		#{noti},riskcode = #{riskcode},riskname = #{riskname},riskshortname =
		#{riskshortname},risktype = #{risktype},provideid =
		#{provideid},status = #{status},renewaltype = #{renewaltype} where id
		= #{id}
	</select>
	<select id="INSBRisk_selectCount" parameterType="Map"
		resultType="Long">
		select count(1) from INSBRisk
		<where>
			<if test="riskcode != null">.
				and riskcode = #{riskcode}
			</if>
			<if test="riskname != null">
				and riskname = #{riskname}
			</if>
			<if test="riskshortname != null">
				and riskshortname = #{riskshortname}
			</if>
			<if test="risktype != null">
				and risktype = #{risktype}
			</if>
			<if test="provideid != null">
				and provideid = #{provideid}
			</if>
			<if test="status != null">
				and status = #{status}
			</if>
			<if test="renewaltype != null">
				and renewaltype = #{renewaltype}
			</if>
		</where>
	</select>

	<select id="INSBRisk_selectVo" parameterType="Map"  resultType="com.zzb.conf.entity.INSBRisk">
		select
		id,operator,createtime,modifytime,noti,riskcode,riskname,riskshortname,
		(select codename from INSCCode where codetype='risktype' and codevalue=c.risktype ) risktype ,
		(select prvname from INSBProvider p where p.id =c.provideid) providename,
		(select codename from INSCCode where codetype='riskstatus' and codevalue=c.status ) status,
		renewaltype 
		from INSBRisk c
		<where>
			<if test="riskcode != null">
				and riskcode like CONCAT('%', #{riskcode},'%')
			</if>
			<if test="riskname != null">
				and riskname like CONCAT('%', #{riskname},'%')
			</if>
			<if test="riskshortname != null">
				and c.riskshortname like CONCAT('%', #{riskshortname},'%')
			</if>
			<if test="risktype != null">
				and c.risktype = #{risktype}
			</if>
			<if test="provideid != null">
				and c.provideid = #{provideid}
			</if>
			<if test="status != null">
				and c.status = #{status}
			</if>
			<if test="renewaltype != null">
				and c.renewaltype = #{renewaltype}
			</if>
		</where>
		limit #{offset},#{limit}
	</select>
	<select id="INSBRisk_selectVorownum" parameterType="Map"  resultType="com.zzb.conf.entity.INSBRisk">
		select @rownum:=@rownum+1 as rownum, id,operator,createtime,modifytime,noti,riskcode,riskname,riskshortname,
		<!-- (select codename from INSCCode where codetype='risktype' and codevalue=c.risktype ) risktype , -->
		risktype,
		(select prvname from INSBProvider p where p.id =c.provideid) providename,
		(select codename from INSCCode where codetype='riskstatus' and codevalue=c.status ) status,
		renewaltype 
		from INSBRisk c ,(select @rownum:=0) b
		<where>
			<if test="riskcode != null">
				and riskcode like CONCAT('%', #{riskcode},'%')
			</if>
			<if test="riskname != null">
				and riskname like CONCAT('%', #{riskname},'%')
			</if>
			<if test="riskshortname != null">
				and c.riskshortname like CONCAT('%', #{riskshortname},'%')
			</if>
			<!-- <if test="risktype != null">
				and c.risktype = #{risktype}
			</if> -->
			<if test="provideid != null">
				and c.provideid = #{provideid}
			</if>
			<if test="status != null">
				and c.status = #{status}
			</if>
			<if test="renewaltype != null">
				and c.renewaltype = #{renewaltype}
			</if>
		</where>
		<!-- order by a.createtime desc -->
		order by 
		<if test="sort != null and order != null">
			  ${sort}  ${order}  
		</if>
		<if test="sort == null">
			 createtime desc 
		</if>
		limit #{offset},#{limit}
	</select>
	<select id="INSBRisk_selectVoCount" parameterType="Map"
		resultType="Long">
		select count(1) from INSBRisk
		<where>
			<if test="riskcode != null">
				and riskcode = #{riskcode}
			</if>
			<if test="riskname != null">
				and riskname like CONCAT('%', #{riskname},'%')
			</if>
			<if test="riskshortname != null">
				and riskshortname like CONCAT('%', #{riskshortname},'%')
			</if>
			<if test="risktype != null">
				and risktype = #{risktype}
			</if>
			<if test="provideid != null">
				and provideid = #{provideid}
			</if>
			<if test="status != null">
				and status = #{status}
			</if>
			<if test="renewaltype != null">
				and renewaltype = #{renewaltype}
			</if>
		</where>
	</select>
	
	<select id="INSBRisk_selectByModifyDate" parameterType="Map"
		resultType="com.zzb.conf.entity.INSBRisk">
		select * from INSBRisk
		<where>
			<if test="_parameter  != null">
				and DATE_FORMAT(modifytime, '%Y-%c-%d') = #{_parameter}
			</if>
		</where>
	</select>
	<select id="INSBRisk_selectRiskListByMap" parameterType="Map"
		resultType="Map">
		select
		a.id,
		a.riskcode,
		a.riskname,
		a.risktype,
		a.provideid,
		a.status,
		b.kindcode,
		b.kindname,
		b.isamount,
		b.amountselect,
		b.preriskkind,
		b.notdeductible,
		b.isusing
		from
		insbrisk a
		left join insbriskkind b on a.id = b.riskid
		<where>
			
				 a.provideid = #{_parameter}		
		</where>
	</select>
</mapper>