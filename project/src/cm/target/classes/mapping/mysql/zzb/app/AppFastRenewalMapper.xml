<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="appFastRenewal">
	<select id="getAllProviderList" parameterType="Map" resultType="Map">
		 SELECT p.id,p.prvcode,p.prvname,p.prvshotname 
		 FROM insbagent a,insbagentprovider ap,insbprovider p
		 WHERE a.id = ap.agentid AND p.id = ap.providerid 
		<if test="jobnum != null and jobnum != ''">
				and a.jobnum = #{jobnum}
		</if>
		<if test="stationid != null and stationid != ''">
				and a.stationid = #{stationid}
		</if>
		<if test="channeltype != null and channeltype != ''">
				and p.channeltype = #{channeltype}
		</if>
	</select>
	<select id="getChildProviderList" parameterType="String" resultType="com.zzb.conf.entity.INSBProvider">
		 SELECT * FROM insbprovider WHERE parentcode = #{pid}
	</select>
	
	<select id="getShippingAddressList" parameterType="String" resultType="Map">
		SELECT liv.recipientaddress address,liv.recipientprovince provinceId,liv.recipientcity cityId,liv.recipientname contactName ,liv.zip postCode,liv.recipientmobilephone contactTel,liv.recipientarea zoneId
		FROM insbperson person ,insctask task , insborder ord ,insborderdelivery liv 
		<where>
		 	person.taskid = task.id AND task.id = ord.taskid  AND liv.orderid = ord.id 
		 	<if test="_parameter!=null and _parameter != ''">
		 		AND person.id = #{_parameter}
		 	</if>
		</where>
	</select>
	
	<select id="queryAgentPowerByAgentId" parameterType="String" resultType="Map">
		SELECT ap.agentid,ap.permissionid,ap.frontstate,ap.weblogin,ap.phonelogin,ap.deviceslogin,ap.num,
		ap.functionstate,ap.validtimestart,ap.validtimeend,ap.abort,ap.status,p.permissionname,p.permissionpath 
		FROM insbagentpermission ap,insbpermission p
		WHERE ap.permissionid = p.id 
		<if test="_parameter != null and _parameter != ''">
				and ap.agentid = #{_parameter}
		</if>
	</select>
	<select id="queryPayExpressinfo" parameterType="Map" resultType="Map">
		SELECT DISTINCT
		chann.favorabledescribe 'concessionsDesc',chann.paytarget 'payTarget',chann.collectiontype 'payee',chann.paychannelid 'payChannel',chann.sort 'displayOrder',
		dis.distpaytype deliveryFreight,dis.noti 'desc'
	 FROM insbprovider pro,insbagreement agr,insbdistributiontype dis ,insbpaychannelmanager chann 
		<where> 
			pro.id = agr.providerid AND dis.agreementid = agr.id AND chann.agreementid = agr.id 
			<if test="id!=null and id != ''">
				AND pro.id = #{id}
			</if>
			<if test="cityCode!=null and cityCode != ''">
				
			</if>
		</where>
	</select>
	
	<select id="queryPayTarget" parameterType="String" resultType="String">
		SELECT codename FROM insccode 
		<where>
			codetype = 'tradingobject' 
			<if test="codevalue!=null and codevalue !=''">
				and codevalue= #{codevalue}
			</if>
		</where> 
	</select>
	<select id="queryPay" parameterType="String" resultType="com.zzb.conf.entity.INSBPaychannel">
		SELECT pay.* FROM insbpaychannelmanager manger,insbpaychannel pay 
		<where>
			 pay.id=manger.paychannelid 
			<if test="_parameter!=null and _parameter != ''">
				AND manger.paychannelid = #{_parameter}
			</if>
		</where>
	</select>
	
	<select id="queryInsureConfigByKey" parameterType="String" resultType="com.zzb.app.model.InsureConfigModel">
		SELECT c.id,p.planname,p.plankey,c.type,c.riskkindname,c.riskkindcode,
		c.prekindcode,c.isdeductible,c.datatemp 
		FROM insbriskkindconfig c,insbriskplanrelation p 
 		<where>
			<if test="_parameter!=null and _parameter != ''">
				p.plankey = #{_parameter}
			</if>
			 AND p.isshow = 0 AND p.riskkindid = c.id 
		</where>
	</select>
	
	<select id="queryRiskItemsByProviderids" parameterType="java.util.List" resultType="com.zzb.conf.entity.INSBRiskitem">
		SELECT i.* FROM insbriskitem i,insbrisk r
		WHERE i.riskid = r.id 
		<if test="list != null and list.size() > 0">
			AND r.provideid IN
			<foreach item="item" index="index" collection="list" open="(" separator="," close=")">
	            #{item}
	         </foreach>
         </if>
	</select>
</mapper>